honey开发手记（5月份）
=======================

5-3
--------
五一放假浪得像狗一样。在知乎上面回答了一题， 嘚瑟一下  
[编程语言会影响程序员的性格吗？](http://www.zhihu.com/question/29973769/answer/46557920)

另外最近在看mongodb， 直接适用于django的好像并没有合适的， 但是可以使用这个 <https://github.com/MongoEngine/mongoengine>  

今天连接尝试连接mongodb的数据库的时候一直失败， 后来发现是pymongo3.0 刚刚发布， mongoengine和它还不是很兼容， 降到2.8就可以了。  

使用还是蛮方便的， 但是一开始用connect连接的时候没有指定数据库名字， 于是自动连上了`test`， 之后再用`connect`指定名字连接的时候也改不过来。  
总而言之， 感觉使用函数connect来连接非常的诡异， 虽然返回的是pymongo的Client对象， 但是一直都没有使用它， 非常诡异。  

2015年05月03日21:44:56

5-5
-------
html前端太菜了。  
ajax一直不会， 于是变成我来写了。。。  

说一下ajax的cors的问题， 主要是浏览器限制了ajax只能同域名， 所以向其他域名甚至是不同接口请求的时候会失败， Post 就更别想了  

可以在django设置允许其他域名的ajax请求。  
我用了这个库  
<https://github.com/ottoyiu/django-cors-headers>  
配置一下就飞起来了。  

顺便扯一点别的， 晚上刚好在知乎上看到这样一个问题 [跟「不」优秀的人相处是怎样一种体验？](http://www.zhihu.com/question/29903822)  

排名靠前的答案基本都说出了我的心声啊啊啊啊啊。 比如要浪费很多时间， 精力，和他们解释， 最后的结局就是放着我来。。。  

再扯一下， js的字符串用起来感觉和python一样爽也。  `url.split('#')[0]`  

补充一下， 前端我是加了ajax请求。。并不是完全我写的= =


5-6
-------
今天在写用户的注册和登陆， 因为苹果新的要求， 没有实现应用内注册的应用不能上线。  

User 是不能够使用`get_or_create`这个方法的，创建用户要特别的使用`create_user`方法， 这是因为密码加密的原因。 普通的`create`方法是对User失效的。  

另外是短信验证注册， 利用redis缓存了一下验证码和发送的手机， 用于防止暴力post请求，  和自动让验证码失效。

主要用到的是`cache.set(key, val, nx=True)` ， nx是not exist 的意思， 吧？  目的是当前key没有被设置的时候才设置生效， 返回True， 否则返回False。  

注意这个貌似是特定cache backend 支持的， 我没有考证过。

2015年05月06日20:43:16

5-7
----------
今天用了celery的result的功能， 虽然使用的姿势有点不对， 我再代码中等待异步的结果， 结局还是同步， 主要是异步的任务可能会出现超时的情况（其实主要还是想用result）， 加了超时的参数

`task.delay(timeout=timeout)` 

如果超时的话会引发一个异常， 需要捕获来处理超时。  

2015年05月07日20:55:18

5-8 再见
--------
今天最后完成了登录， 注册， 短信验证找回密码等功能。  

本人已于5月8日晚上申请离职， 代码继续维护至5月20日。  

闲话一下， 这个是周日（5-10）写的， 离职后的感觉另开一个来记录吧。  
怎么说呢， 可能光是看这个笔记的话会感觉比较突兀吧， 有些话是只能记录下来后留给自己看的， 我写好之后再push一下吧。  

那， 这个既然已经离职了， 这个记录就到此为止， 画上一个句号吧。  
如果可能， 我以后会fork这个项目继续记录自己的一些学习体验。  

再见！  

littlezz，  
于 2015年05月10日22:47:56
